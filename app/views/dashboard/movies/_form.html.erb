<div class="container mx-auto px-6 py-10 bg-gray-900 min-h-screen text-white">
  <div class="bg-gray-800 shadow-md rounded-lg p-8">
    <h1 class="text-4xl font-bold text-red-500 mb-6">
      <%= movie.persisted? ? t('movies_form.edit_movie') : t('movies_form.new_movie') %>
    </h1>

    <%= form_with model: [:dashboard, movie], class: 'space-y-6' do |f| %>
      <% if movie.errors.any? %>
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
          <ul class="list-disc list-inside text-red-800">
            <% movie.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div>
        <%= f.label :title, t('movies_form.title'), class: 'block text-gray-300 font-medium mb-2' %>
        <div class="flex gap-2">
          <%= f.text_field :title, placeholder: t('movies_form.title_placeholder'), class: 'flex-1 border border-gray-600 rounded px-3 py-2 bg-gray-900 text-white focus:outline-none focus:ring-1 focus:ring-red-500 focus:border-red-500', id: 'movie_title' %>
          <button 
            type="button" 
            id="fetch_movie_ai_btn"
            class="bg-red-500 hover:bg-blue-700 text-white px-4 py-2 rounded transition cursor-pointer"
          >
            <%= t('movies_form.fetch_with_ai') %>
          </button>
        </div>
      </div>

      <!-- Sinopse -->
      <div>
        <%= f.label :synopsis, t('movies_form.synopsis'), class: 'block text-gray-300 font-medium mb-2' %>
        <%= f.text_area :synopsis, placeholder: t('movies_form.synopsis_placeholder'), rows: 5, class: 'w-full border border-gray-600 rounded px-3 py-2 bg-gray-900 text-white focus:outline-none focus:ring-1 focus:ring-red-500 focus:border-red-500', id: 'movie_synopsis' %>
      </div>

      <!-- Ano / Duração / Diretor -->
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
        <div>
          <%= f.label :release_year, t('movies_form.release_year'), class: 'block text-gray-300 font-medium mb-2' %>
          <%= f.number_field :release_year, placeholder: t('movies_form.release_year_placeholder'), class: 'w-full border border-gray-600 rounded px-3 py-2 bg-gray-900 text-white focus:outline-none focus:ring-1 focus:ring-red-500 focus:border-red-500', id: 'movie_release_year' %>
        </div>

        <div>
          <%= f.label :duration, t('movies_form.duration_minutes'), class: 'block text-gray-300 font-medium mb-2' %>
          <%= f.number_field :duration, placeholder: t('movies_form.duration_placeholder'), class: 'w-full border border-gray-600 rounded px-3 py-2 bg-gray-900 text-white focus:outline-none focus:ring-1 focus:ring-red-500 focus:border-red-500', id: 'movie_duration' %>
        </div>

        <div>
          <%= f.label :director, t('movies_form.director'), class: 'block text-gray-300 font-medium mb-2' %>
          <%= f.text_field :director, placeholder: t('movies_form.director_placeholder'), class: 'w-full border border-gray-600 rounded px-3 py-2 bg-gray-900 text-white focus:outline-none focus:ring-1 focus:ring-red-500 focus:border-red-500', id: 'movie_director' %>
        </div>
      </div>

      <!-- Categorias -->
      <div>
        <%= f.label :category_ids, t('movies_form.categories'), class: 'block text-gray-300 font-medium mb-2' %>
        <div class="flex flex-wrap gap-2">
          <% Category.all.each do |category| %>
            <label class="flex items-center">
              <%= check_box_tag 'movie[category_ids][]', category.id, movie.categories.include?(category),
                  id: "category_#{category.id}", class: 'hidden peer' %>
              <span class="cursor-pointer px-4 py-2 rounded-full border border-gray-600 text-gray-300 
                            peer-checked:bg-red-500 peer-checked:text-white hover:bg-gray-700 transition">
                <%= category.name %>
              </span>
            </label>
          <% end %>
        </div>
      </div>

      <!-- Tags -->
      <div>
        <%= f.label :tag_list, t('movies_form.tags'), class: 'block text-gray-300 font-medium mb-2 mt-4' %>
        <%= f.text_field :tag_list, placeholder: t('movies_form.tags_placeholder'), class: 'w-full border border-gray-600 rounded px-3 py-2 bg-gray-900 text-white focus:outline-none focus:ring-1 focus:ring-red-500 focus:border-red-500' %>
      </div>

      <div class="relative">
        <%= f.file_field :cover_image, class: "absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10" %>

        <div class="flex items-center justify-center gap-2 border border-gray-600 rounded px-3 py-2 bg-gray-900 text-gray-200 hover:bg-gray-800 cursor-pointer z-0">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1M12 12v8m0-8l-3 3m3-3l3 3m-3-12v8" />
          </svg>
          <span><%= t('movies_form.cover_image_button') %></span>
        </div>
      </div>

      <div class="flex flex-col sm:flex-row gap-4 mt-6">
        <%= f.submit t('movies_form.save'), class: 'bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded transition cursor-pointer w-full sm:w-auto' %>
        <%= link_to t('movies_form.cancel'), dashboard_movies_path, class: 'bg-gray-700 hover:bg-gray-600 text-gray-200 px-6 py-2 rounded transition cursor-pointer w-full sm:w-auto text-center' %>
      </div>
    <% end %>
  </div>
</div>
